# HTTPS (Hypertext Transfer Protocol Secure)
## HTTP
웹에서 클라이언트와 서버 간 통신을 위한 통신 규약이다. 하지만, HTTP는 암호화되지 않은 평문으로 데이터를 전송하기 때문에 보안에 취약하다. 이로 인해 제 3자가 중간에 데이터를 조회할 수 있어 탈취되거나 변조될 위험이 있다.
## HTTPS
HTTP에 데이터 암호화 기능을 추가한 프로토콜이다. HTTPS는 TLS(Transport Layer Security, 이전 명칭: SSL) 프로토콜을 사용하여 클라이언트와 서버 간의 통신을 암호화한다. 이를 통해 데이터의 제 3자로부터의 접근을 차단하여 기밀성과 무결성을 보장할 수 있다.

## HTTPS는 어떻게 적용되는가?
HTTPS를 적용하기 위해서는 인증된 기관(CA, Certificate Authority)에서 발급한 TLS 인증서가 필요하다. 
CA에 인증서를 요청하면 CA 이름, 서버의 공개키, 서버의 정보를 활용하여 인증서를 생성하고 이를 CA 개인 키로 암호화하여 서버로 전송한다. 이때 인증서는 CA 개인 키로 암호화되니 신뢰성을 확보할 수 있다.
이러한 인증서를 서버측에서 발급받으면 HTTPS를 적용할 수 있다.

이 인증서에는 다음과 같은 정보가 포함된다:
- 서버 도메인명
- 공개키
- 만료 기간
- 발급자(CA)의 서명 정보 등

## HTTPS의 동작 원리
1. **클라이언트 요청**: 클라이언트가 HTTPS URL로 서버에 접속을 시도한다.
   이때 암호화 알고리즘, 프로토콜 버전, 무작위 값을 전달한다.
2. **서버 응답**: 서버는 자신의 TLS 인증서와 암호화 알고리즘, 무작위 값을 포함한 응답을 클라이언트에게 보낸다.
3. **인증서 검증**: 클라이언트는 서버의 TLS 인증서를 CA의 공개키로 검증한다. 
4. **무작위 값 조합**: 검증 이후 클라이언트와 서버에서 생성된 무작위 값을 조합하여 Pre-Master Secret을 생성하고 서버의 공개키로 암호화하여 전달한다.
5. **복호화**: 서버는 전달받은 암호화된 데이터를 개인키로 복호화하여 Pre-Master Secret을 얻는다.
6. **세션 키 생성**: 클라이언트와 서버는 앞선 과정에서 얻은 Pre-Master Secret를 Master Secret로 변환하고, 이를 기반으로 세션 키를 생성한다.
   Master Secret은 클라이언트와 서버가 서로 주고받은 무작위 값과 Pre-Master Secret을 기반으로 생성된다.
   이 과정은 양측 모두 동일하게 수행되어 동일한 세션 키를 만들어낸다.
> 이러한 과정을 TLS 핸드쉐이크라고 한다.
7. **암호화된 통신 시작**: 클라이언트와 서버는 생성된 세션키를 활용한 대칭키 암호화 방식으로 데이터 송수신을 수행한다. 이로 인해 데이터는 암호화되어 전송되며, 제 3자가 데이터를 탈취하거나 변조하는 것을 방지할 수 있다.


## 인증서 체인 구조

인증서는 다음과 같은 구조로 체인 형성을 통해 신뢰를 확보한다:
- Root CA → Intermediate CA → Server Certificate
클라이언트(브라우저)는 Root CA의 공개키를 미리 내장하고 있으며, 이를 통해 인증서의 유효성을 검증할 수 있다.

## HTTPS의 단점

| 단점 | 설명 |
|------|------|
| 속도 저하 | TLS 핸드쉐이크 과정에서 1~2 RTT 필요 |
| 리소스 사용 | 암호화/복호화 연산이 CPU 자원을 소모함 |
| 캐시 활용 어려움 | 중간 프록시 서버가 HTTPS 데이터를 캐싱하기 어려움 |

## TLS 핸드쉐이크 흐름 요약

```
[Client] → Hello + Random + 알고리즘 목록
[Server] → Hello + Random + 인증서
[Client] → 인증서 검증 → Pre-Master Secret 생성 → 서버 공개키로 암호화하여 전송
[Server] → 개인키로 복호화
→ 서로 동일한 Master Secret 생성
→ 세션 키로 대칭키 암호화 통신 시작
```

## 면접에서 자주 나오는 질문 예시

- "HTTPS는 어떻게 신뢰할 수 있나요?" → 인증서 + CA 서명 구조
- "HTTPS에서 세션 키는 어떻게 주고받나요?" → Pre-Master Secret을 공개키로 암호화
- "HTTPS도 중간자 공격이 가능한가요?" → 가능, HSTS/인증서 Pinning 등으로 보완 가능